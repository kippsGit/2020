
<html>
<head>
	<title>K.P.G.P.& M.B.</title>
<style type="text/css">
	body{
		margin: 0;
		padding: 0;
		user-select: none;
	}
	canvas{
		visibility: hidden;
	}
</style>
</head>
<body>
<center>
<canvas id="canvas"></canvas>
<script type="text/javascript">
	let canvas = document.querySelector("#canvas"),
		c = canvas.getContext("2d"),
		/*canvas.width = window.innerWidth;
		canvas.height = window.innerHeight;*/
		frame = 0;
		frame2 = 0;

		canvas.width = 900;
		canvas.height = 1764;

		let canvas_width = window.innerWidth,
			canvas_height = window.innerHeight;

		let groundImg = new Image(),
			treeImg = new Image(),
			backgroundImage = new Image(),
			carImage = new Image(),
			boatImage = new Image(),
			titleImage = new Image(),
			sky = new Image(),
			signStandImage = new Image(),
			cloudImage = new Image(),
			humanImage = new Image(),
			infoBoxImage = new Image();

		groundImg.src = "ground.png";
		treeImg.src = "tree.png";
		backgroundImage.src = "background.png";
		boatImage.src = "boat.png";
		titleImage.src = "title.png";
		sky.src = "sky.png";
		signStandImage.src = "signStand.png";
		cloudImage.src = "clouds.png";
		humanImage.src = "walker.png";

		let carCollection = ["redCar.png", "blueCar.png", "yellowCar.png", "carrYellow.png"],
			CCindex = Math.floor(Math.random()*carCollection.length);
			carImage.src = carCollection[CCindex];

		let infoBoxCollection = ["info1.png", "info2.png", "info3.png", "info4.png", "info5.png"],
			IBCindex = Math.floor(Math.random()*infoBoxCollection.length);
			infoBoxImage.src = infoBoxCollection[IBCindex];

		let objectClicked = "none";

		let title = {
			w: 700,
			h: 350,
			posX: 0,
			posY: 0,

			draw: function(){
					
				this.posX = canvas.width/2-this.w/2;
				this.posY = canvas.height/2-this.h;

				/*c.fillStyle = "red";
				c.fillRect(this.posX, this.posY, this.w, this.h);*/

				c.drawImage(titleImage, 0, 0, 700, 350, this.posX, this.posY, this.w, this.h)
			}
		}

		let signStand = function(){
			this.index = 304;
			this.siz = {
				w: 304,
				h: 318
			}
			this.posX = canvas.width/2 - this.siz.w/2;
			this.posY = canvas.height/2 + canvas.height/10 - 20;

			this.draw = ()=>{

				/*c.fillStyle = "red";
				c.fillRect(this.posX, this.posY, this.siz.w, this.siz.w);*/

				c.drawImage(signStandImage, this.index, 0, this.siz.w, this.siz.h, this.posX, this.posY, this.siz.w, this.siz.h);
			}
		};let signStand1 = new signStand(); 

		let cloudsObject = function(vx, x){

			this.pos = {
				x: x,
				y: 0
			}
			this.vel = {
				x: vx,
				y: 0
			}
			this.update = ()=>{
				this.pos.x += this.vel.x;

				if(this.pos.x < 0 - cloudImage.width){
					this.pos.x = canvas.width;
				}
			}
			this.draw = ()=>{
				c.drawImage(cloudImage, this.pos.x, this.pos.y);

				this.update();
			}

		}; let cloud1 = new cloudsObject(-2, 0),
			   cloud2 = new cloudsObject(-2, canvas.width);

		let backGround = {

			posX: 0,
			posY: 0,
			index: 0,

			update: function(){
				if(frame % 24 == 0){
					this.index += 1500;
					if(this.index > 3000){
						this.index = 0;
					}	
				}
				
			},

			draw: function(){
				/*c.fillStyle = "gray";
				c.fillRect(this.posX, this.posY, canvas.width, canvas.height);*/
				c.drawImage(backgroundImage, this.index, 0, canvas.width, canvas.height, this.posX, this.posY, canvas.width, canvas.height);

				this.update();
			}
		}

		let ground = {
			posX: 0,
			posY: 0,

			draw: function(){

				this.posX = 0;
				this.posY = canvas.height/2 - canvas.height/100;

				/*c.fillStyle = "brown";
				c.fillRect(this.posX,this.posY, canvas.width, canvas.height);*/
				c.drawImage(groundImg, 0, 0, canvas.width/2, 480, this.posX, this.posY, canvas.width, 900);

			}
		}

		let treeObject = function(){
			this.index = 0;
			this.siz = {
				w: 1600,
				h: 1600
			}
			this.pos = {
				x: canvas.width/2,
				y: -270
			}

			this.draw = ()=>{
				/*c.fillStyle = "green";
				c.fillRect(this.pos.x, this.pos.y, this.siz.w, this.siz.h);*/
				c.drawImage(treeImg, this.index, 0, 800, 700, this.pos.x, this.pos.y, this.siz.w, this.siz.h)
			}

		}; let tree = new treeObject();

		let leafObject = function(){
			this.pos = {
				x: canvas.width/2,
				y: canvas.height/2
			}

			this.draw = ()=>{
				c.fillStyle = "red";
				c.fillRect(this.pos.x, this.pos.y, 20, 20);
			}
		}; let leaf = new leafObject();

		let carObject = function(){
			this.showSig = 0;
			this.showSigMax = Math.floor(Math.random()*300);

			this.index = 0;
			this.siz = {
				w: 800,
				h: 450
			}
			this.pos = {
				x: canvas.width,
				y: canvas.height / 2 + canvas.height / 6
			}
			this.vel = {
				x: -20,
				y: 0
			}
			this.update = ()=>{
				this.pos.x += this.vel.x;

				this.index += 288;

				this.showSig++;


				//console.log("max: " + this.showSigMax, this.showSig)
				if(this.pos.x <= 0 - this.siz.w){
					if(this.showSig >= this.showSigMax){
						this.pos.x = canvas.width;
						CCindex = Math.floor(Math.random()*carCollection.length);
						carImage.src = carCollection[CCindex];
						this.vel.x = Math.floor(Math.random()*-50 + -20);

						this.showSig = 0;
						this.showSigMax = Math.floor(Math.random()*300);
					}
						

				}

				if(this.index > 864	){
					this.index = 0;
				}
			}
			this.draw = ()=>{
				/*c.fillStyle = "blue";
				c.fillRect(this.pos.x, this.pos.y, this.siz.w, this.siz.h);*/

				c.drawImage(carImage, this.index, 0, 288, 144, this.pos.x, this.pos.y, this.siz.w, this.siz.h);

				this.update();
			}

		}; let car = new carObject();

		let boatObject = function(){
			this.index = 0;
			this.siz = {
				w: 500,
				h: 300
			}
			this.pos = {
				x: 0 - this.siz.w,
				y: canvas.height / 4
			}
			this.vel = {
				x: 5,
				y: 0
			}
			this.update = ()=>{

				this.pos.x += this.vel.x;

				if(frame % 6 == 0){
					this.index += 624;
					if(this.index > 1248){
						this.index = 0;
					}
				}

				if(this.pos.x >= canvas.width){
					this.pos.x = 0 - this.siz.w;
				}
			}
			this.draw = ()=>{
				/*c.fillStyle = "black";
				c.fillRect(this.pos.x, this.pos.y, this.siz.w, this.siz.h);*/

				c.drawImage(boatImage, this.index, 0, 624, 230, this.pos.x, this.pos.y, this.siz.w, this.siz.h)

				this.update();
			}

		}; let boat = new boatObject();

		let humanObject = function(){
			this.index = 512;
			this.siz = {
				w: 200,
				h: 400
			}
			this.pos = {
				x: canvas.width,
				y: canvas.height/2 + canvas.height/4 - 40/* - this.siz.h/4*/ - this.siz.h
			}
			this.vel = {
				x: -20,
				y: 0
			}
			this.update = ()=>{
				this.pos.x += this.vel.x;

				if(frame % 2 == 0){
					this.index -= 128;
					if(this.index < 0){
						this.index = 512;
					}
				}
				

				if(this.pos.x < 0 - this.siz.w){
					this.pos.x = canvas.width;
				}
			}
			this.draw = ()=>{
				/*c.fillStyle = "white";
				c.fillRect(this.pos.x, this.pos.y, this.siz.w, this.siz.h)*/
				c.drawImage(humanImage, this.index, 0, 128, 222, this.pos.x, this.pos.y, this.siz.w, this.siz.h);
				
				this.update();
			}
		};let human = new humanObject();

		let infoBoxObject = function(){
			this.siz = {
				w: 400,
				h: 700
			}
			this.pos = {
				x: 50,
				y: 130
			}

			this.draw = ()=>{
				/*c.fillStyle = "red";
				c.fillRect(this.pos.x, this.pos.y, this.siz.w, this.siz.h);*/
				c.drawImage(infoBoxImage, 0, 0, 400, 700, this.pos.x, this.pos.y, this.siz.w, this.siz.h);
			}
		};let infoBox = new infoBoxObject()
		
		//game loop
		setInterval(()=>{
			frame++;
			frame2++;

			c.clearRect(0,0,canvas.width,canvas.height);
			c.drawImage(sky, 0, 0, canvas.width, canvas.height)
			cloud1.draw();
			cloud2.draw();
			backGround.draw();
			boat.draw();
			ground.draw();
			tree.draw();
			
			//leaf.draw();
			
			if(objectClicked == "signStand"){
				title.draw();
			}
			//human.draw();

			signStand1.draw();
			car.draw();

			if(objectClicked == "tree"){
				infoBox.draw();
				
			}
			

		}, 60);

		function getMousePos(canvas, e){
			let rect = canvas.getBoundingClientRect(),
				scaleX = canvas.width / rect.width,
				scaleY = canvas.height / rect.height;

				return {
					x: (e.clientX - rect.left) * scaleX,
					y: (e.clientY - rect.top) * scaleY
				}
		}
		function getDist(mouseX, mouseY, objectX, objectY){
			let xDist = objectX - mouseX,
				yDist = objectY - mouseY;

				return Math.sqrt(Math.pow(xDist, 2) + Math.pow(yDist, 2));
		}

		//mouse events
		canvas.addEventListener("click",(e)=>{
			//if only clicked on the canvas then reset things
			/*objectClicked = "none";
			signStand1.index = 304;
			tree.index = 0;*/
			//console.log(e)
			//console.log("canvas w h: " + canvas_width, canvas_height);
			//console.log("mouse x y: " + cX, cY)
			
			//console.clear();
			/*console.log(signStand1.posX, signStand1.posX + signStand1.siz.w);
			console.log(signStand1.posY, signStand1.posY + signStand1.siz.h);*/
			//console.log("mouseX: " + getMousePos(canvas, e).x);
			//console.log("mouseY: " + getMousePos(canvas, e).y);

			//signStand1.posX = getMousePos(canvas, e).x;
			//signStand1.posY = getMousePos(canvas, e).y;

			//sign stand trigger
			if(getMousePos(canvas, e).x > signStand1.posX && getMousePos(canvas, e).x < signStand1.posX + signStand1.siz.w && getMousePos(canvas, e).y > signStand1.posY && getMousePos(canvas, e).y < signStand1.posY + signStand1.siz.h){

				if(objectClicked == "signStand"){
					objectClicked = "none";
					signStand1.index = 304;
				}else{
					objectClicked = "signStand";
					signStand1.index = 0;
				}
			}
			//tree trigger
			if(getMousePos(canvas, e).x > tree.pos.x && getMousePos(canvas, e).x < tree.pos.x + tree.siz.w && getMousePos(canvas, e).y > tree.pos.y && getMousePos(canvas, e).y < tree.pos.y + tree.siz.h - tree.siz.h/2){
				
				if(objectClicked == "tree"){
					objectClicked = "none";
					tree.index = 0;
				}else{
					objectClicked = "tree";
					tree.index = 400;
					IBCindex = Math.floor(Math.random()*infoBoxCollection.length);
					infoBoxImage.src = infoBoxCollection[IBCindex];
				}

			}
			
		})
		canvas.addEventListener("mousemove", (e)=>{
			canvas.style.cursor = "default";

			//sign stand location trigger
			if(getMousePos(canvas, e).x > signStand1.posX && getMousePos(canvas, e).x < signStand1.posX + signStand1.siz.w && getMousePos(canvas, e).y > signStand1.posY && getMousePos(canvas, e).y < signStand1.posY + signStand1.siz.h){

				canvas.style.cursor = "pointer";
				
			}
			//tree trigger
			if(getMousePos(canvas, e).x > tree.pos.x && getMousePos(canvas, e).x < tree.pos.x + tree.siz.w && getMousePos(canvas, e).y > tree.pos.y && getMousePos(canvas, e).y < tree.pos.y + tree.siz.h - tree.siz.h/2){

				canvas.style.cursor = "pointer";
			}
		})

		///////////////////////////////////////////////////////////////////////////////////

		function adjustScreen(){

			canvas_width = window.innerWidth;
			canvas_height = window.innerHeight;

			let ratio = 16 / 9;

			if(canvas_width < canvas_height / ratio){
				canvas_height = canvas_width * ratio;
			}else{
				canvas_width = canvas_height / ratio;
			}

			canvas.style.width = "" + canvas_width + "px";
			canvas.style.height = "" + canvas_height  + "px";
		}
		adjustScreen();
		window.addEventListener("resize", ()=>{
			adjustScreen();
		})

		window.onload = ()=>{
			canvas.style.visibility = "visible";
		}
</script>
</body>
</html>